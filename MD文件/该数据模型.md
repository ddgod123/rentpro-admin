# 数据初始化SQL文件说明

## 概述

本项目已将数据初始化方式从代码实现改为SQL文件方式，按照业务模块分类管理，便于维护和扩展。

## 文件结构

```
config/data/
├── sys_dept.sql        # 部门数据
├── sys_post.sql        # 岗位数据  
├── sys_role.sql        # 角色数据
├── sys_menu.sql        # 菜单数据
├── sys_user.sql        # 用户数据
├── sys_role_menu.sql   # 角色菜单关联数据
└── README.md           # 本说明文件
```

## 文件说明

### 1. sys_dept.sql - 部门数据
- 包含系统组织架构的部门信息
- 支持层级结构，通过 parent_id 和 dept_path 实现
- 包含部门负责人、联系方式等基本信息

### 2. sys_post.sql - 岗位数据  
- 定义系统中的职位类型
- 包含岗位编码、名称、排序等信息
- 用于用户岗位分配和权限控制

### 3. sys_role.sql - 角色数据
- 定义系统角色类型
- 包含管理员角色、普通用户角色、租客角色、房东角色等
- 控制不同角色的权限范围

### 4. sys_menu.sql - 菜单数据
- 系统菜单树结构定义
- 包含一级菜单：仪表板、系统管理、租赁管理
- 包含二级菜单：用户管理、角色管理、楼盘管理等
- 每个菜单关联相应的权限标识

### 5. sys_user.sql - 用户数据
- 系统初始用户数据
- 包含超级管理员(admin)和测试用户(test)
- 密码字段将由系统自动进行加密处理

### 6. sys_role_menu.sql - 角色菜单关联数据
- 定义角色与菜单的关联关系
- 超级管理员拥有所有菜单权限
- 普通用户只有基本的业务菜单权限

## 使用方式

### 自动加载
系统启动时会自动按照依赖关系顺序加载所有SQL文件：
1. 部门数据 (sys_dept.sql)
2. 岗位数据 (sys_post.sql)  
3. 角色数据 (sys_role.sql)
4. 菜单数据 (sys_menu.sql)
5. 用户数据 (sys_user.sql)
6. 角色菜单关联 (sys_role_menu.sql)

### 手动执行
也可以通过命令行工具手动执行数据迁移：
```bash
go run main.go migrate
```

## 优势

1. **分离关注点**: 数据与代码分离，便于维护
2. **分类管理**: 按业务模块分类，结构清晰
3. **易于扩展**: 新增数据只需添加对应SQL文件
4. **版本控制**: SQL文件可以进行版本管理
5. **数据审查**: 数据变更更容易审查和追踪
6. **环境配置**: 不同环境可以使用不同的数据文件

## 注意事项

1. **字符编码**: SQL文件应使用UTF-8编码
2. **语法规范**: 遵循标准SQL语法规范
3. **数据完整性**: 确保外键关联数据的完整性
4. **重复执行**: 系统支持重复执行，会自动跳过重复数据
5. **依赖关系**: 严格按照依赖关系顺序加载数据文件

## 迁移说明

原有的代码实现方式已标记为弃用（Deprecated），但保留在代码中作为参考。新的项目应该使用SQL文件方式进行数据初始化。

如需回滚到代码实现方式，可以参考 `auth_init.go` 文件中的备份函数。